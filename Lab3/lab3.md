# Lab 3: PID control and Line Following

The goal of this lab was to have the TurtleBot follow a line of black tape on the ground. This was done using a camera node (provided by the course instructors) which would take in informtation from the TurtleBot's camera (facing the floor) and return the location of the column of pixels that was, on average, the darkest. Since the tape was much darker than the lab floor, this node was used to determine if the TurtleBot was to the left or to the right of the line, and then it was up to us to determine how to use this information to control the TurtleBot. The camera had a resolution of 480x640 (height by width) pixels, so each of the line following algorithms is attempting to regulate the darkest column variable to 320, by applying motion controls to the TurtleBot that would center the TurtleBot with respect to the tape. To have the TurtleBot follow the line, a constant linear velocity was applied, and the depending on how far the TurtleBot was off from the line (i.e. how far the darkest column determined by the camera node was from 320), different angular velocities were applied to regulate the robot back onto the line.

We progressed through the lab by implementing increasingly more complex regulation algorithsm to keep the robot centered. The first method, called a 'bang-bang' method, simply applies a preset angular velocity anytime the robot is not centered. If the robot was to the left of the line the robot would turn right, and vice versa. The issue is that since the angular velocity was the same for all kinds of curves and regardless of the distance to the cetner, the motion of the robot was unstable and inefficient.

We then applied PID (proportional, integral, derivative) which determined the angular velocity using terms related to the instant error (error meaning distance to the center of the line), the integral of the error over time, and the time derivative of the error. The last two were calculated numerically rather than analytically. The correct multiplicative coefficients for each of the three terms were determined through trial and error. The TurtleBot with PID control was able to follow much more complex curves with tighter turns very closely and was much more stable.

Finally, as a slight modification to the PID control, instead of having a term proportional to the error, we replaced it with a term proportional to the square of the error. This was an attempt to decrease the amount of angular velocity applied when the robot was closer to the line and increase the angular velocity applied for very large errors, and hopefully make a more stable robot. This method made minor but noteiceable improvements to the TurtleBot's stability and decreased overshoot issues, and was our preferred line following algorithm. This method for line following was used in both Lab 4 and the mail delivery project, and is referred to as SID (square, integral, derivative) control in the documentation for each.
